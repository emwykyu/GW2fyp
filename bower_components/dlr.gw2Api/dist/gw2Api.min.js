/*!
 * gw2Api.js 0.5.0
 * https://github.com/dyanarose/gw2Api.js
 * Copyright 2015-2015 Dyana Rose; Licensed MIT
 */

!function(a,b){"function"==typeof define&&define.amd?define("gw2Api",["Q"],function(c){return a.gw2Api=b(c)}):"object"==typeof exports?module.exports=b(require("Q")):a.gw2Api=b(Q)}(this,function(a){function b(a){"use strict";this.message=a}function c(a,b,c,d){"use strict";var e,f,g,h;return e=a,f=b,g=c,h=d,{get pageSize(){return e},get pageTotal(){return f},get resultCount(){return g},get resultTotal(){return h}}}function d(a,c,d,g){"use strict";function h(){return d?j:i}function i(a){var b=k()(a);return e.get(b)}function j(a){var c;if(!a.token)throw new b("token must be set on params when calling an authenticated endpoint");return c=k()(a),e.get(c)}function k(){return d?m:l}function l(a){return a.url(p,g)}function m(a){var b=l(a);return a.token&&(b=n(b,a.token)),b}function n(a,b){var c="access_token="+b;return a.indexOf("?")>=0?a+"&"+c:a+"?"+c}function o(){return this.paramType?new f.params[g]:{}}var p=f.config.createUrl(c);this.key=a,this.urlFormat=p,this.isAuthenticated=d,this.paramType=g,this.get=h(),this.getParameters=o,this.url=k()}var e,f={};!function(){"use strict";function b(a,b){var c=d(a,b);return f.config.withCredentials&&(c.withCredentials=!0),h(c)}function d(a,b){var c=new XMLHttpRequest,d=b;return c.open("GET",a,!0),b&&(f.utils.checks.isArray(b)||(d=[b]),g(c,d)),c.responseType="json",c}function g(a,b){var c,d;for(c=0;c<b.length;c++){d=b[c];for(var e in d)d.hasOwnProperty(e)&&a.setRequestHeader(e,d[e])}}function h(b){function d(a){return(a||"").toLowerCase()}function e(a){var b,d,e,f;return b=a["x-page-size"],d=a["x-page-total"],e=a["x-result-count"],f=a["x-result-total"],c(b,d,e,f)}function g(a){var b,c,e,f={};return a?(a.split("\n").forEach(function(a){e=a.indexOf(":"),b=d(a.substr(0,e).trim()),c=a.substr(e+1).trim(),b&&(f[b]?f[b]+=", "+c:f[b]=c)}),f):f}function h(a){var b="object"==typeof a?a:void 0;return function(c){return b||(b=g(a)),c?b[d(c)]:b}}var j,k,l=a.defer(),m=l.promise,n=-1;return b.onreadystatechange=function(){var a,c,d,f,g;4==b.readyState&&(j!==n&&(c=b.getAllResponseHeaders(),a=b.responseType?b.response:b.responseText),k&&clearTimeout(k),j=j||b.status,b=null,j=Math.max(1223==j?204:j,0),d=h(c)(),f=e(d),(g=i(j)?l.resolve:l.reject)({data:a,status:j,rawHeaders:d,headers:f}))},b.onprogress=function(a){l.notify(a)},b.send(),f.config.timeout>0&&(k=setTimeout(function(){j=n,b&&b.abort()},f.config.timeout)),m}function i(a){return a>=200&&300>a}e={get:b}}();var g;return function(){"use strict";function a(a,b,c){var d,e,f,g,h,i;for(d=a.split("."),g=d.length-1,f=d[g],h=c,e=0;g>e;e++)i=d[e],h[i]?h=h[i]:(h[i]={},h=h[i]);h[d[g]]=b}function c(a){var b=Array.prototype.slice.call(arguments,1);return a.replace(/{(\d+)}/g,function(a,c){return"undefined"!=typeof b[c]?b[c]:a})}function d(){return{toInt:j}}function e(){return{notEmpty:f,isNumber:i,isArray:Array.isArray,isString:h}}function f(a){var b;return a||0===a?(b=a.toString().trim,!!b):!1}function h(a){return"string"==typeof a}function i(a){return"number"==typeof a}function j(a){var c,d;if(d=a.toString().match(/^-?\d+$/gm),!d)throw new b("value must be a number");if(c=parseInt(a,10),isNaN(c)||!i(c))throw new b("value must be a number");return c}g={converters:d(),checks:e(),format:c,splitIdentifier:a}}(),function(){function a(){"use strict";function a(a){return b+c.v2+a}var b="https://api.guildwars2.com",c={v2:"/v2/"};return{createUrl:a,defaultLang:null}}f.config=a()}(),function(){"use strict";function a(){function a(a){return g.checks.notEmpty(a)?g.converters.toInt(a):null}var b,c,d;b=f.config.defaultLang,this.type="CommonParams",Object.defineProperty(this,"lang",{get:function(){return b},set:function(a){b=a},enumerable:!0}),Object.defineProperty(this,"page",{get:function(){return c},set:function(b){c=a(b)},enumerable:!0}),Object.defineProperty(this,"pageSize",{get:function(){return d},set:function(b){d=a(b)},enumerable:!0})}function c(){var b;a.apply(this,arguments),this.type="AuthParams",Object.defineProperty(this,"token",{get:function(){return b},set:function(a){b=a},enumerable:!0})}function d(){function a(a){if(!g.checks.notEmpty(a))return null;if(g.checks.isString(a)||g.checks.isNumber(a))return a;throw new b("value must be a number or string")}var d;c.apply(this,arguments),this.type="IdAuthParams",Object.defineProperty(this,"id",{get:function(){return d},set:function(b){d=a(b)},enumerable:!0})}function e(){function c(a){if(!g.checks.notEmpty(a))return null;if(g.checks.isString(a)||g.checks.isNumber(a))return a;throw new b("value must be a number or string")}var d;a.apply(this,arguments),this.type="IdParams",Object.defineProperty(this,"id",{get:function(){return d},set:function(a){d=c(a)},enumerable:!0})}function h(){d.apply(this,arguments),this.type="CharacterParams"}function i(){function a(a){if(!a&&0!==a)return null;if(g.checks.isArray(a))return a;if(g.checks.isString(a))return a.split(",");if(g.checks.isNumber(a))return[a];throw new b('value must be an array, number, string or "all"')}function c(b){var c=a(b);c&&(e?e.concat(c):e=c)}var e;d.apply(this,arguments),this.type="IdsAuthParams",this.add=c,Object.defineProperty(this,"ids",{get:function(){return e},set:function(b){e=a(b)},enumerable:!0})}function j(){function a(a){if(!a&&0!==a)return null;if(g.checks.isArray(a))return a;if(g.checks.isString(a))return a.split(",");if(g.checks.isNumber(a))return[a];throw new b('value must be an array, number, string or "all"')}function c(b){var c=a(b);c&&(d?d.concat(c):d=c)}var d;e.apply(this,arguments),this.type="IdsParams",this.add=c,Object.defineProperty(this,"ids",{get:function(){return d},set:function(b){d=a(b)},enumerable:!0})}function k(){function b(a){return g.checks.notEmpty(a)?g.checks.isString(a)?a:g.converters.toInt(a):null}var c;a.apply(this,arguments),this.type="QuantityParams",Object.defineProperty(this,"quantity",{get:function(){return c},set:function(a){c=b(a)},enumerable:!0})}function l(){function a(a){return g.checks.notEmpty(a)?g.checks.isString(a)?a:g.converters.toInt(a):null}var b;j.apply(this,arguments),this.type="FloorParams",Object.defineProperty(this,"continent",{get:function(){return b},set:function(c){b=a(c)},enumerable:!0})}function m(){function a(a){return g.checks.notEmpty(a)?g.checks.isString(a)?a:g.converters.toInt(a):null}var b;l.apply(this,arguments),this.type="RegionParams",Object.defineProperty(this,"floor",{get:function(){return b},set:function(c){b=a(c)},enumerable:!0})}function n(){function a(a){return g.checks.notEmpty(a)?g.checks.isString(a)?a:g.converters.toInt(a):null}var b;m.apply(this,arguments),this.type="MapParams",Object.defineProperty(this,"region",{get:function(){return b},set:function(c){b=a(c)},enumerable:!0})}function o(){function a(a){return g.checks.notEmpty(a)?g.checks.isString(a)?a:g.converters.toInt(a):null}var b;n.apply(this,arguments),this.type="SectorParams",Object.defineProperty(this,"map",{get:function(){return b},set:function(c){b=a(c)},enumerable:!0})}function p(){o.apply(this,arguments),this.type="PoiParams"}function q(){o.apply(this,arguments),this.type="TaskParams"}function r(){function b(a){return a&&0!==a&&(f=null),d(a)}function c(a){return a&&0!==a&&(e=null),d(a)}function d(a){return g.checks.notEmpty(a)?g.checks.isString(a)?a:g.converters.toInt(a):null}var e,f;a.apply(this,arguments),this.type="RecipeSearchParams",Object.defineProperty(this,"output",{get:function(){return e},set:function(a){e=b(a)},enumerable:!0}),Object.defineProperty(this,"input",{get:function(){return f},set:function(a){f=c(a)},enumerable:!0})}f.params={CommonParams:a,AuthParams:c,IdAuthParams:d,IdParams:e,CharacterParams:h,IdsAuthParams:i,IdsParams:j,QuantityParams:k,FloorParams:l,RegionParams:m,MapParams:n,SectorParams:o,PoiParams:p,TaskParams:q,RecipeSearchParams:r},a.prototype.url=function(a,b){var c;return this.type===b&&(c=this.getQueryString()),c?a+"?"+c:a},a.prototype.getQueryString=function(){var a=[];return this.lang&&a.push("lang="+this.lang),(this.page||0===this.page)&&a.push("page="+this.page),this.pageSize&&a.push("page_size="+this.pageSize),a.join("&")},c.prototype.url=a.prototype.url,c.prototype.getQueryString=function(){return a.prototype.getQueryString.call(this)},d.prototype.url=c.prototype.url,d.prototype.getQueryString=function(){var a=[],b=c.prototype.getQueryString.call(this);return b&&a.push(b),(this.id||0===this.id)&&a.push("id="+this.id),a.join("&")},e.prototype.url=a.prototype.url,e.prototype.getQueryString=function(){var b=[],c=a.prototype.getQueryString.call(this);return c&&b.push(c),(this.id||0===this.id)&&b.push("id="+this.id),b.join("&")},h.prototype.url=function(a,b){var d=c.prototype.url.call(this,a,b);return d=g.format(d,this.id)},h.prototype.getQueryString=function(){var a=[],b=c.prototype.getQueryString.call(this);return b&&a.push(b),a.join("&")},i.prototype.url=d.prototype.url,i.prototype.getQueryString=function(){var a=[],b=d.prototype.getQueryString.call(this);return b&&a.push(b),this.ids&&this.ids.length?(a.push("ids="+this.ids.join(",")),a.join("&")):a.join("&")},j.prototype.url=e.prototype.url,j.prototype.getQueryString=function(){var a=[],b=e.prototype.getQueryString.call(this);return b&&a.push(b),this.ids&&this.ids.length?(a.push("ids="+this.ids.join(",")),a.join("&")):a.join("&")},k.prototype.url=j.prototype.url,k.prototype.getQueryString=function(){var b=[],c=a.prototype.getQueryString.call(this);return c&&b.push(c),this.quantity&&b.push("quantity="+this.quantity),b.join("&")},l.prototype.url=function(a,b){var c=j.prototype.url.call(this,a,b);return c=g.format(c,this.continent)},l.prototype.getQueryString=function(){var a=[],b=j.prototype.getQueryString.call(this);return b&&a.push(b),a.join("&")},m.prototype.url=function(a,b){var c=j.prototype.url.call(this,a,b);return c=g.format(c,this.continent,this.floor)},m.prototype.getQueryString=l.prototype.getQueryString,n.prototype.url=function(a,b){var c=j.prototype.url.call(this,a,b);return c=g.format(c,this.continent,this.floor,this.region)},n.prototype.getQueryString=m.prototype.getQueryString,o.prototype.url=function(a,b){var c=j.prototype.url.call(this,a,b);return c=g.format(c,this.continent,this.floor,this.region,this.map)},o.prototype.getQueryString=n.prototype.getQueryString,p.prototype.url=o.prototype.url,p.prototype.getQueryString=o.prototype.getQueryString,q.prototype.url=o.prototype.url,q.prototype.getQueryString=o.prototype.getQueryString,r.prototype.url=a.prototype.url,r.prototype.getQueryString=function(){var b=[],c=a.prototype.getQueryString.call(this);return c&&b.push(c),this.input?b.push("input="+this.input):this.output&&b.push("output="+this.output),b.join("&")}}(),function(){"use strict";function a(a){g.splitIdentifier(a.key,a,c),e.push(a.key)}function b(){a(new d("account.url","account",!0,"AuthParams")),a(new d("account.bank.url","account/bank",!0,"AuthParams")),a(new d("account.dyes.url","account/dyes",!0,"AuthParams")),a(new d("account.materials.url","account/materials",!0,"AuthParams")),a(new d("account.skins.url","account/skins",!0,"AuthParams")),a(new d("account.wallet.url","account/wallet",!0,"AuthParams")),a(new d("build.url","build",!1,"CommonParams")),a(new d("characters.url","characters",!0,"IdsAuthParams")),a(new d("characters.inventory.url","characters/{0}/inventory",!0,"CharacterParams")),a(new d("characters.equipment.url","characters/{0}/equipment",!0,"CharacterParams")),a(new d("colors.url","colors",!1,"IdsParams")),a(new d("commerce.exchange.url","commerce/exchange",!1,"CommonParams")),a(new d("commerce.exchange.coins.url","commerce/exchange/coins",!1,"QuantityParams")),a(new d("commerce.exchange.gems.url","commerce/exchange/gems",!1,"QuantityParams")),a(new d("commerce.listings.url","commerce/listings",!1,"IdsParams")),a(new d("commerce.prices.url","commerce/prices",!1,"IdsParams")),a(new d("commerce.transactions.url","commerce/transactions",!0,"AuthParams")),a(new d("commerce.transactions.current.url","commerce/transactions/current",!0,"AuthParams")),a(new d("commerce.transactions.current.buy.url","commerce/transactions/current/buy",!0,"AuthParams")),a(new d("commerce.transactions.current.sell.url","commerce/transactions/current/sell",!0,"AuthParams")),a(new d("commerce.transactions.history.url","commerce/transactions/history",!0,"AuthParams")),a(new d("commerce.transactions.history.buy.url","commerce/transactions/history/buy",!0,"AuthParams")),a(new d("commerce.transactions.history.sell.url","commerce/transactions/history/sell",!0,"AuthParams")),a(new d("currencies.url","currencies",!1,"IdsParams")),a(new d("continents.url","continents",!1,"IdsParams")),a(new d("floors.url","continents/{0}/floors",!1,"FloorParams")),a(new d("regions.url","continents/{0}/floors/{1}/regions",!1,"RegionParams")),a(new d("maps.url","continents/{0}/floors/{1}/regions/{2}/maps",!1,"MapParams")),a(new d("sectors.url","continents/{0}/floors/{1}/regions/{2}/maps/{3}/sectors",!1,"SectorParams")),a(new d("pois.url","continents/{0}/floors/{1}/regions/{2}/maps/{3}/pois",!1,"PoiParams")),a(new d("pvp.games.url","pvp/games",!0,"AuthParams")),a(new d("pvp.stats.url","pvp/stats",!0,"AuthParams")),a(new d("tasks.url","continents/{0}/floors/{1}/regions/{2}/maps/{3}/tasks",!1,"TaskParams")),a(new d("files.url","files",!1,"IdsParams")),a(new d("items.url","items",!1,"IdsParams")),a(new d("materials.url","materials",!1,"IdsParams")),a(new d("quaggans.url","quaggans",!1,"IdsParams")),a(new d("recipes.url","recipes",!1,"IdsParams")),a(new d("recipes.search.url","recipes/search",!1,"RecipeSearchParams")),a(new d("specializations.url","specializations",!1,"IdsParams")),a(new d("traits.url","traits",!1,"IdsParams")),a(new d("skins.url","skins",!1,"IdsParams")),a(new d("tokenInfo.url","tokeninfo",!0,"AuthParams")),a(new d("worlds.url","worlds",!1,"IdsParams"))}var c={},e=[];b(),f.endpoints=c,f.endpointKeys=e}(),f});